<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KaspiPricePilot</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .blur-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.5s ease;
        }

        .unlock-container {
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .unlock-input {
            width: 100%;
            padding: 12px;
            margin: 15px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .unlock-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }

        .unlock-btn:hover {
            background: #45a049;
        }

        .error-message {
            color: #f44336;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>

<body>
    <div id="app">

        <div class="container">
            <div class="header">
                <h1 id="company-name">æ–°ç–†èˆªè´¸é€šå›½é™…ä¾›åº”é“¾æœ‰é™å…¬å¸</h1>
                <h2 id="app-title">Kaspi ç”µå•†åˆ©æ¶¦è®¡ç®—å™¨</h2>
                <div class="countdown-container" id="countdownContainer" 
                     style="position: absolute; top: 10px; left: 10px; z-index: 1000;
                            background: rgba(255,255,255,0.9); padding: 5px 10px; border-radius: 4px;
                            box-shadow: 0 2px 5px rgba(0,0,0,0.1); border: 1px solid #eee;">
                    <span id="countdown" style="color: #d35400; font-weight: bold;">æœåŠ¡æœ‰æ•ˆæœŸ: åŠ è½½ä¸­...</span>
                </div>
                <div class="language-switcher">
                    <button class="lang-btn active" data-lang="zh">ä¸­æ–‡</button>
                    <button class="lang-btn" data-lang="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</button>
                </div>
            </div>
            <div class="exchange-rate">
                <label id="exchange-label">å½“å‰æ±‡ç‡ï¼š1å…ƒäººæ°‘å¸å…‘æ¢</label>
                <input id="exchangeRate" min="0" placeholder="è¾“å…¥æ±‡ç‡" step="0.01" type="number" value="70" />
                <label id="currency-label">å“ˆè¨å…‹æ–¯å¦åšæˆˆ</label>
                <div class="error-message" id="exchange-error">æ±‡ç‡å¿…é¡»å¤§äº0</div>
            </div>
            <div class="input-section">
                <div class="section">
                    <h3 class="section-title" id="product-info-title">äº§å“ä¿¡æ¯</h3>
                    <div class="form-group category-container">
                        <label for="category-search" id="category-label">å•†å“åˆ†ç±»</label>
                        <div class="category-search">
                            <input autocomplete="off" class="form-control" id="category-search" placeholder="æœç´¢åˆ†ç±»..."
                                type="text" />
                            <span class="search-icon">ğŸ”</span>
                            <div class="search-results" id="search-results"></div>
                        </div>
                        <select class="form-control" id="category-select" title="å•†å“åˆ†ç±»é€‰æ‹©" aria-label="è¯·é€‰æ‹©å•†å“åˆ†ç±»">
                            <option data-commission="" value="">-- è¯·é€‰æ‹©å•†å“åˆ†ç±» --</option>
                        </select>
                        <div class="commission-display" id="commission-display">å½“å‰ä½£é‡‘ç‡ï¼š0%</div>
                    </div>
                    <div class="form-group">
                        <label for="purchasePrice" id="purchase-label">é‡‡è´­ä»· (Â¥)</label>
                        <input class="form-control" id="purchasePrice" min="0" placeholder="è¾“å…¥é‡‡è´­ä»·" step="0.01"
                            type="number" value="" />
                        <div class="error-message" id="purchase-error">è¯·è¾“å…¥æœ‰æ•ˆçš„é‡‡è´­ä»·</div>
                    </div>
                    <div class="form-group">
                        <label for="shippingCost" id="shipping-label">è¿è´¹ (Â¥)</label>
                        <input class="form-control" id="shippingCost" min="0" placeholder="é˜¿æ‹‰æœ¨å›¾è¿è´¹" step="0.01"
                            type="number" value="" />
                        <div class="error-message" id="shipping-error">è¯·è¾“å…¥æœ‰æ•ˆçš„è¿è´¹</div>
                    </div>
                    <div class="form-group">
                        <label for="grossProfit" id="gross-profit-label">è®¡åˆ’æ¯›åˆ© (Â¥)</label>
                        <input class="form-control" id="grossProfit" min="0" placeholder="è¾“å…¥è®¡åˆ’æ¯›åˆ©" step="0.01"
                            type="number" value="" />
                        <div class="error-message" id="profit-error">è¯·è¾“å…¥æœ‰æ•ˆçš„è®¡åˆ’æ¯›åˆ©</div>
                    </div>
                    <div class="form-group">
                        <label for="cashback" id="cashback-label">ä¸‹å•è¿”åˆ©ï¼ˆ%ï¼‰</label>
                        <input class="form-control" id="cashback" min="0" placeholder="è¾“å…¥ä¸‹å•è¿”åˆ©" step="0.1" type="number"
                            value="" />
                    </div>
                    <div class="form-group">
                        <label for="paymentMethod" id="payment-label">æ±‡æ¬¾æ–¹å¼</label>
                        <select class="form-control" id="paymentMethod">
                            <option value="publicToPublic">é“¶è¡Œå…¬å¯¹å…¬</option>
                            <option value="publicToPrivate">é“¶è¡Œå…¬å¯¹ç§</option>
                            <option value="privateToPrivate">é“¶è¡Œç§å¯¹ç§</option>
                            <option value="wechat">å¾®ä¿¡</option>
                            <option value="alipay">æ”¯ä»˜å®</option>
                            <option value="kaspi">Kaspi.kz</option>
                        </select>
                    </div>
                </div>
                <div class="section">
                    <h3 class="section-title" id="logistics-title">ç‰©æµä¿¡æ¯</h3>
                    <div class="form-group">
                        <label id="dimension-label">å°ºå¯¸ï¼ˆå˜ç±³ï¼‰</label>
                        <div class="dimensions">
                            <div>
                                <label for="length" class="dimension-sub-label">é•¿åº¦</label>
                                <input class="form-control" id="length" min="0.1" placeholder="é•¿" step="0.1"
                                    type="number" value="" />
                            </div>
                            <div>
                                <label for="width" class="dimension-sub-label">å®½åº¦</label>
                                <input class="form-control" id="width" min="0.1" placeholder="å®½" step="0.1"
                                    type="number" value="" />
                            </div>
                            <div>
                                <label for="height" class="dimension-sub-label">é«˜åº¦</label>
                                <input class="form-control" id="height" min="0.1" placeholder="é«˜" step="0.1"
                                    type="number" value="" />
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="volume" id="volume-label">ä½“ç§¯ï¼ˆç«‹æ–¹ç±³ï¼‰</label>
                        <input class="form-control output-value" id="volume" readonly="" type="text" />
                    </div>
                    <div class="form-group">
                        <label for="weight" id="weight-label">é‡é‡ï¼ˆåƒå…‹ï¼‰</label>
                        <input class="form-control" id="weight" min="0.01" placeholder="è¾“å…¥é‡é‡" step="0.01" type="number"
                            value="" />
                        <div class="error-message" id="weight-error">è¯·è¾“å…¥æœ‰æ•ˆçš„é‡é‡</div>
                    </div>
                    <div class="form-group">
                        <label id="kaspi-price-label">Kaspi å”®ä»·</label>
                        <div class="kaspi-price-container">
                            <div class="kaspi-price-box">
                                <div class="kaspi-price-label" id="kaspi-price-cny-label">äººæ°‘å¸ (Â¥)</div>
                                <input class="form-control output-value" id="kaspiPriceCny" readonly="" type="text"
                                    title="Kaspiå”®ä»·(äººæ°‘å¸)" aria-label="Kaspiå¹³å°å”®ä»·ï¼Œäººæ°‘å¸é‡‘é¢" />
                            </div>
                            <div class="kaspi-price-box">
                                <div class="kaspi-price-label" id="kaspi-price-kzt-label">åšæˆˆ (â‚¸)</div>
                                <input class="form-control output-value" id="kaspiPriceKzt" readonly="" type="text"
                                    title="Kaspiå”®ä»·(åšæˆˆ)" aria-label="Kaspiå¹³å°å”®ä»·ï¼Œå“ˆè¨å…‹æ–¯å¦åšæˆˆé‡‘é¢" />
                            </div>
                        </div>
                    </div>
                    <div class="cost-price-container">
                        <div class="cost-price-group">
                            <label id="overseas-unit-label">æµ·å¤–ä»“å•ä»· (Â¥/mÂ³)</label>
                            <input id="overseasUnitPrice" min="0" step="1" type="number" value="1000"
                                title="æµ·å¤–ä»“å•ä»·(å…ƒ/ç«‹æ–¹ç±³)" aria-label="æµ·å¤–ä»“å­˜å‚¨å•ä»·ï¼Œå•ä½äººæ°‘å¸æ¯ç«‹æ–¹ç±³" placeholder="è¾“å…¥å•ä»·" />
                        </div>
                        <div class="cost-price-group">
                            <label id="firstmile-unit-label">å¤´ç¨‹å•ä»· (Â¥/mÂ³)</label>
                            <input id="firstMileUnitPrice" min="0" step="1" type="number" value="100"
                                title="å¤´ç¨‹å•ä»·(å…ƒ/ç«‹æ–¹ç±³)" aria-label="å¤´ç¨‹è¿è¾“å•ä»·ï¼Œå•ä½äººæ°‘å¸æ¯ç«‹æ–¹ç±³" placeholder="è¾“å…¥å•ä»·" />
                        </div>
                    </div>
                </div>
            </div>
            <button class="btn-calculate" data-ru="Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ±Ñ‹Ğ»ÑŒ" data-zh="è®¡ç®—åˆ©æ¶¦" id="calculateBtn">è®¡ç®—åˆ©æ¶¦</button>

            <!-- å¢å€¼æœåŠ¡å’Œä¸šåŠ¡å’¨è¯¢ç§»åŠ¨åˆ°è®¡ç®—æŒ‰é’®ä¸‹æ–¹ -->
            <div class="advertisement-section">
                <h3 class="section-title ad-title" id="ad-title">å¢å€¼æœåŠ¡</h3>
                <div class="ad-grid">
                    <div class="ad-item">æµ·å¤–ä»“æœåŠ¡</div>
                    <div class="ad-item">Kaspiå¤´ç¨‹ç‰©æµ</div>
                    <div class="ad-item">Kaspiç”µå•†å…¥é©»</div>
                    <div class="ad-item">ä¸­äºšå›½é™…ç‰©æµ</div>
                    <div class="ad-item">ç­¾è¯ä»£åŠæœåŠ¡</div>
                    <div class="ad-item">è½¦è¾†å‡ºå¢ƒæ‰‹ç»­</div>
                    <div class="ad-item">æµ·å¤–å…¬å¸æ³¨å†Œ</div>
                    <div class="ad-item">ä¸­äºšæµ·å¤–ä»“</div>
                    <div class="ad-item">äº§å“ç”µå•†ä»£å”®</div>
                </div>
            </div>

            <div class="contact-section">
                <div class="contact-info" id="contact-info">
                    <span>ä¸šåŠ¡å’¨è¯¢ï¼š</span>
                    <a href="#" id="contact-link">ç‚¹å‡»è”ç³»å®¢æœ</a>
                </div>
            </div>

            <div class="output-section">
                <div class="section">
                    <h3 class="section-title" id="fees-title">å¤´ç¨‹ã€æµ·å¤–ä»“è´¹ç”¨</h3>
                    <div class="switch-container">
                        <span class="switch-label" id="overseas-toggle-label">æ˜¯å¦è®¡ç®—æµ·å¤–ä»“è´¹ç”¨</span>
                        <label class="switch">
                            <input checked="" id="overseasToggle" type="checkbox" title="åˆ‡æ¢æµ·å¤–ä»“è´¹ç”¨è®¡ç®—"
                                aria-label="åˆ‡æ¢æ˜¯å¦è®¡ç®—æµ·å¤–ä»“è´¹ç”¨" />
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="output-group">
                        <label id="overseas-label">æµ·å¤–ä»“è´¹ç”¨</label>
                        <input class="form-control output-value" id="overseasWarehouse" readonly="" type="text"
                            title="æµ·å¤–ä»“è´¹ç”¨è®¡ç®—ç»“æœ" aria-label="è®¡ç®—å¾—å‡ºçš„æµ·å¤–ä»“è´¹ç”¨é‡‘é¢">
                    </div>
                    <div class="switch-container">
                        <span class="switch-label" id="firstmile-toggle-label">æ˜¯å¦è®¡ç®—å¤´ç¨‹è´¹ç”¨</span>
                        <label class="switch">
                            <input checked="" id="firstMileToggle" type="checkbox" title="åˆ‡æ¢å¤´ç¨‹è´¹ç”¨è®¡ç®—"
                                aria-label="åˆ‡æ¢æ˜¯å¦è®¡ç®—å¤´ç¨‹è¿è¾“è´¹ç”¨" />
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="output-group">
                        <label id="firstmile-label">å¤´ç¨‹è´¹ç”¨</label>
                        <input class="form-control output-value" id="firstMile" readonly="" type="text" title="å¤´ç¨‹è´¹ç”¨è®¡ç®—ç»“æœ"
                            aria-label="è®¡ç®—å¾—å‡ºçš„å¤´ç¨‹è¿è¾“è´¹ç”¨é‡‘é¢">
                    </div>
                </div>
                <div class="section">
                    <h3 class="section-title" id="platform-title">å¹³å°è´¹ç”¨</h3>
                    <div class="output-group">
                        <label id="cashback-amount-label">ä¸‹å•è¿”åˆ©</label>
                        <input class="form-control output-value" id="cashbackAmount" readonly="" type="text"
                            title="ä¸‹å•è¿”åˆ©è®¡ç®—ç»“æœ" aria-label="è®¡ç®—å¾—å‡ºçš„ä¸‹å•è¿”åˆ©é‡‘é¢">
                    </div>
                    <div class="output-group">
                        <label id="kaspi-shipping-label">Kaspi è¿è´¹</label>
                        <input class="form-control output-value" id="kaspiShipping" readonly="" type="text"
                            title="Kaspiè¿è´¹è®¡ç®—ç»“æœ" aria-label="è®¡ç®—å¾—å‡ºçš„Kaspiå¹³å°è¿è´¹é‡‘é¢">
                    </div>
                    <div class="output-group">
                        <label id="platform-fee-label">å¹³å°ä½£é‡‘</label>
                        <input class="form-control output-value" id="platformFee" readonly="" type="text"
                            title="å¹³å°ä½£é‡‘è®¡ç®—ç»“æœ" aria-label="è®¡ç®—å¾—å‡ºçš„å¹³å°ä½£é‡‘é‡‘é¢" />
                    </div>
                    <div class="output-group">
                        <label id="withdrawal-tax-label">æç°ç¨ï¼ˆ4%ï¼‰</label>
                        <input class="form-control output-value" id="withdrawalTax" readonly="" type="text"
                            title="æç°ç¨è®¡ç®—ç»“æœ" aria-label="è®¡ç®—å¾—å‡ºçš„æç°ç¨é‡‘é¢" />
                    </div>
                </div>
            </div>
            <div class="results-section">
                <h3 class="section-title" id="return-title">å›æ¬¾è´¹ç”¨</h3>
                <div class="switch-container">
                    <span class="switch-label" id="withdrawal-fee-toggle-label">æ˜¯å¦è®¡ç®—æç°æ‰‹ç»­è´¹</span>
                    <label class="switch">
                        <input checked="" id="withdrawalFeeToggle" type="checkbox" title="åˆ‡æ¢æç°æ‰‹ç»­è´¹è®¡ç®—"
                            aria-label="åˆ‡æ¢æ˜¯å¦è®¡ç®—æç°æ‰‹ç»­è´¹" />
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="output-group">
                    <label id="withdrawal-fee-label">æç°æ‰‹ç»­è´¹ï¼ˆ1%ï¼‰</label>
                    <input class="form-control output-value" id="withdrawalFee" readonly="" type="text"
                        title="æç°æ‰‹ç»­è´¹è®¡ç®—ç»“æœ" aria-label="è®¡ç®—å¾—å‡ºçš„æç°æ‰‹ç»­è´¹é‡‘é¢">
                </div>
                <div class="switch-container">
                    <span class="switch-label" id="exchange-loss-toggle-label">æ˜¯å¦è®¡ç®—æ±‡æŸ</span>
                    <label class="switch">
                        <input checked="" id="exchangeLossToggle" type="checkbox" title="åˆ‡æ¢æ±‡æŸè®¡ç®—"
                            aria-label="åˆ‡æ¢æ˜¯å¦è®¡ç®—æ±‡ç‡æŸå¤±è´¹ç”¨" />
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="output-group">
                    <label id="exchange-loss-label">æ±‡æŸï¼ˆ1.42%ï¼‰</label>
                    <input class="form-control output-value" id="exchangeLoss" readonly="" type="text" title="æ±‡æŸè®¡ç®—ç»“æœ"
                        aria-label="è®¡ç®—å¾—å‡ºçš„æ±‡ç‡æŸå¤±é‡‘é¢">
                </div>
                <div class="switch-container">
                    <span class="switch-label" id="remittance-fee-toggle-label">æ˜¯å¦è®¡ç®—æ±‡æ¬¾æ‰‹ç»­è´¹</span>
                    <label class="switch">
                        <input checked="" id="remittanceFeeToggle" type="checkbox" title="åˆ‡æ¢æ±‡æ¬¾æ‰‹ç»­è´¹è®¡ç®—"
                            aria-label="åˆ‡æ¢æ˜¯å¦è®¡ç®—å›½é™…æ±‡æ¬¾æ‰‹ç»­è´¹" />
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="output-group">
                    <label id="remittance-fee-label">æ±‡æ¬¾æ‰‹ç»­è´¹</label>
                    <input class="form-control output-value" id="remittanceFee" readonly="" type="text"
                        title="æ±‡æ¬¾æ‰‹ç»­è´¹è®¡ç®—ç»“æœ" aria-label="è®¡ç®—å¾—å‡ºçš„å›½é™…æ±‡æ¬¾æ‰‹ç»­è´¹é‡‘é¢">
                </div>
                <div class="results-grid">
                    <div class="result-item">
                        <div class="result-label" id="kaspi-pay-label">Kaspi payæç°åˆ°è´¦é‡‘é¢</div>
                        <div class="result-value" id="kaspiPayAmount">0.00</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label" id="return-amount-label">å›æ¬¾é‡‘é¢</div>
                        <div class="result-value" id="returnAmountDisplay">0.00</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label" id="estimated-amount-label">é¢„ä¼°åˆ°è´¦é‡‘é¢</div>
                        <div class="result-value" id="estimatedAmount">0.00</div>
                    </div>
                    <div class="result-item final">
                        <div class="result-label" id="profit-label-final">åˆ©æ¶¦</div>
                        <div class="result-value" id="profit">0.00</div>
                    </div>
                </div>
                <div class="currency-selector">
                    <div class="currency-option">
                        <input checked="" class="currency-radio" id="currency-cny" name="currency" type="radio"
                            value="cny" />
                        <label class="currency-label" for="currency-cny" id="cny-label">äººæ°‘å¸ (CNY)</label>
                    </div>
                    <div class="currency-option">
                        <input class="currency-radio" id="currency-kzt" name="currency" type="radio" value="kzt" />
                        <label class="currency-label" for="currency-kzt" id="kzt-label">å“ˆè¨å…‹æ–¯å¦åšæˆˆ (KZT)</label>
                    </div>
                </div>
            </div>

            <!-- å†å²è®°å½•è¡¨æ ¼åŒºåŸŸ -->
            <div class="history-section">
                <h3 class="section-title" id="history-title">å†å²è®°å½•</h3>
                <div class="history-actions">
                    <button class="history-btn" id="exportHistoryBtn">å¯¼å‡ºä¸ºCSV</button>
                    <button class="history-btn" id="clearHistoryBtn">æ¸…ç©ºå†å²</button>
                </div>
                <div class="history-table-container">
                    <table id="historyTable">
                        <thead>
                            <tr>
                                <th>å•†å“åˆ†ç±»</th>
                                <th>é‡‡è´­ä»·</th>
                                <th>è¿è´¹</th>
                                <th>è®¡åˆ’æ¯›åˆ©</th>
                                <th>ä¸‹å•è¿”åˆ©(%)</th>
                                <th>æ±‡æ¬¾æ–¹å¼</th>
                                <th>å°ºå¯¸(é•¿å®½é«˜)</th>
                                <th>ä½“ç§¯</th>
                                <th>é‡é‡</th>
                                <th>æµ·å¤–ä»“è´¹ç”¨</th>
                                <th>å¤´ç¨‹è´¹ç”¨</th>
                                <th>ä¸‹å•è¿”åˆ©</th>
                                <th>Kaspiè¿è´¹</th>
                                <th>å¹³å°ä½£é‡‘</th>
                                <th>æç°ç¨</th>
                                <th>æç°æ‰‹ç»­è´¹</th>
                                <th>æ±‡æŸ</th>
                                <th>æ±‡æ¬¾æ‰‹ç»­è´¹</th>
                                <th>Kaspiæç°</th>
                                <th>å›æ¬¾é‡‘é¢</th>
                                <th>é¢„ä¼°åˆ°è´¦</th>
                                <th>åˆ©æ¶¦</th>
                                <th>å¸ç§</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="historyTableBody">
                            <!-- å†å²è®°å½•å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- å…è´£å£°æ˜ - æ·»åŠ å¤šè¯­è¨€æ”¯æŒ -->
            <div class="disclaimer-section">
                <h3 class="section-title" id="disclaimer-title">å…è´£å£°æ˜</h3>
                <div class="disclaimer-content" id="disclaimer-content">
                    <p>ä»¥ä¸Šè®¡ç®—ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸ä»£è¡¨æœ€ç»ˆè´¹ç”¨ã€‚å®é™…è´¹ç”¨å¯èƒ½å› å¸‚åœºå˜åŒ–ã€æ±‡ç‡æ³¢åŠ¨ã€å¹³å°æ”¿ç­–è°ƒæ•´ç­‰å› ç´ è€Œæœ‰æ‰€ä¸åŒï¼Œè¯·ä»¥å®é™…æƒ…å†µä¸ºå‡†ã€‚</p>
                    <p>æœ¬è®¡ç®—å™¨æä¾›çš„æ•°æ®ä»…ä½œä¸ºå•†ä¸šå†³ç­–çš„å‚è€ƒä¾æ®ï¼Œä¸æ„æˆä»»ä½•å½¢å¼çš„æ‰¿è¯ºæˆ–ä¿è¯ã€‚ä½¿ç”¨æœ¬å·¥å…·äº§ç”Ÿçš„ä»»ä½•å•†ä¸šé£é™©ç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…ã€‚</p>
                </div>
            </div>

            <div class="footer">
                <p id="copyright">Â© 2023 æ–°ç–†èˆªè´¸é€šå›½é™…ä¾›åº”é“¾æœ‰é™å…¬å¸ | Kaspi ç”µå•†åˆ©æ¶¦è®¡ç®—å™¨</p>
            </div>
        </div>

        <!-- è”ç³»å¼¹çª— -->
        <div id="contactModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div id="modalBody"></div>
            </div>
        </div>
    </div>

    <!-- æ¨¡ç³Šé”å®šå±‚ -->
    <div class="blur-overlay" id="blurOverlay">
        <div class="unlock-container">
            <h2>è¯·è¾“å…¥è®¿é—®å¯†é’¥</h2>
            <input type="text" class="unlock-input" id="keyInput" placeholder="è¾“å…¥æœ‰æ•ˆå¯†é’¥...">
            <button class="unlock-btn" id="unlockBtn">è§£é”ä½¿ç”¨</button>
            <div class="error-message" id="errorMsg">å¯†é’¥æ— æ•ˆæˆ–å·²è¿‡æœŸ</div>
        </div>
    </div>

    <script>
        // æ£€æŸ¥æœ¬åœ°å­˜å‚¨çš„è§£é”çŠ¶æ€
        const storedKey = localStorage.getItem('unlockKey');
        const storedExpiry = localStorage.getItem('unlockExpiry');

        // åˆå§‹éšè—é”™è¯¯ä¿¡æ¯
        document.getElementById('errorMsg').style.display = 'none';

        // å¦‚æœå·²æœ‰æœ‰æ•ˆå¯†é’¥ï¼Œè‡ªåŠ¨éªŒè¯
        if (storedKey && storedExpiry && new Date().getTime() < parseInt(storedExpiry)) {
            verifyKey(storedKey);
        }

        // è§£é”æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        document.getElementById('unlockBtn').addEventListener('click', () => {
            const key = document.getElementById('keyInput').value.trim();
            if (key) {
                verifyKey(key);
            }
        });

        // ç”Ÿæˆè®¾å¤‡å”¯ä¸€ID
        function getDeviceId() {
            let deviceId = localStorage.getItem('deviceId');
            if (!deviceId) {
                // ç”ŸæˆåŸºäºæµè§ˆå™¨æŒ‡çº¹çš„ID
                const fingerprint = [
                    navigator.userAgent,
                    navigator.platform,
                    navigator.hardwareConcurrency,
                    navigator.deviceMemory,
                    screen.width,
                    screen.height,
                    screen.colorDepth,
                    new Date().getTimezoneOffset()
                ].join('|');
                
                // ä½¿ç”¨ç®€å•çš„å“ˆå¸Œç”Ÿæˆå›ºå®šé•¿åº¦çš„ID
                deviceId = 'd-' + hashCode(fingerprint);
                localStorage.setItem('deviceId', deviceId);
            }
            return deviceId;
        }

        // ç®€å•å“ˆå¸Œå‡½æ•°
        function hashCode(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // Convert to 32bit integer
            }
            return Math.abs(hash).toString(16).substring(0, 8);
        }

        // å¯†é’¥éªŒè¯å‡½æ•°
        async function verifyKey(key) {
            try {
                const deviceId = getDeviceId();
                const response = await fetch('/validate_key', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        key,
                        deviceId 
                    })
                });

                const result = await response.json();

                if (result.valid) {
                    // è·å–å¯†é’¥æœ‰æ•ˆæœŸ
                    const keysResponse = await fetch('/api/keys');
                    const keys = await keysResponse.json();
                    const keyData = keys.find(k => k.key === key);

                    // å­˜å‚¨è§£é”çŠ¶æ€
                    localStorage.setItem('unlockKey', key);
                    localStorage.setItem('unlockExpiry', keyData.expiry);
                    localStorage.setItem('deviceId', deviceId);

                    // éšè—æ¨¡ç³Šå±‚
                    document.getElementById('blurOverlay').style.opacity = '0';
                    setTimeout(() => {
                        document.getElementById('blurOverlay').style.display = 'none';
                    }, 500);

                    // è®¾ç½®è¿‡æœŸæ£€æŸ¥
                    const remainingTime = keyData.expiry - new Date().getTime();
                    setTimeout(() => {
                        location.reload(); // è¿‡æœŸååˆ·æ–°é¡µé¢é‡æ–°é”å®š
                    }, remainingTime);

                } else {
                    showError(result.message);
                }
            } catch (error) {
                showError('éªŒè¯å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            const errorMsg = document.getElementById('errorMsg');
            errorMsg.textContent = message;
            errorMsg.style.display = 'block';
            setTimeout(() => {
                errorMsg.style.display = 'none';
            }, 3000);
        }
    </script>

    <script src="translations.js"></script>
    <script src="categories.js"></script>
    <script src="main.js"></script>
</body>

</html>